<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/base32.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/base32.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import charMapping from './charMapping.js';

const ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
const DECODED_BLOCK_SIZE = 5;
const ENCODED_BLOCK_SIZE = 8;

// region encode

const encodeBlock = (input, inputOffset, output, outputOffset) => {
	output[outputOffset + 0] = ALPHABET[input[inputOffset + 0] >> 3];
	output[outputOffset + 1] = ALPHABET[((input[inputOffset + 0] &amp; 0x07) &lt;&lt; 2) | (input[inputOffset + 1] >> 6)];
	output[outputOffset + 2] = ALPHABET[(input[inputOffset + 1] &amp; 0x3E) >> 1];
	output[outputOffset + 3] = ALPHABET[((input[inputOffset + 1] &amp; 0x01) &lt;&lt; 4) | (input[inputOffset + 2] >> 4)];
	output[outputOffset + 4] = ALPHABET[((input[inputOffset + 2] &amp; 0x0F) &lt;&lt; 1) | (input[inputOffset + 3] >> 7)];
	output[outputOffset + 5] = ALPHABET[(input[inputOffset + 3] &amp; 0x7F) >> 2];
	output[outputOffset + 6] = ALPHABET[((input[inputOffset + 3] &amp; 0x03) &lt;&lt; 3) | (input[inputOffset + 4] >> 5)];
	output[outputOffset + 7] = ALPHABET[input[inputOffset + 4] &amp; 0x1F];
};

// endregion

// region decode

const Char_To_Decoded_Char_Map = (() => {
	const builder = charMapping.createBuilder();
	builder.addRange('A', 'Z', 0);
	builder.addRange('2', '7', 26);
	return builder.map;
})();

const decodeChar = c => {
	const decodedChar = Char_To_Decoded_Char_Map[c];
	if (undefined !== decodedChar)
		return decodedChar;

	throw Error(`illegal base32 character ${c}`);
};

const decodeBlock = (input, inputOffset, output, outputOffset) => {
	const bytes = new Uint8Array(ENCODED_BLOCK_SIZE);
	for (let i = 0; i &lt; ENCODED_BLOCK_SIZE; ++i)
		bytes[i] = decodeChar(input[inputOffset + i]);

	output[outputOffset + 0] = (bytes[0] &lt;&lt; 3) | (bytes[1] >> 2);
	output[outputOffset + 1] = ((bytes[1] &amp; 0x03) &lt;&lt; 6) | (bytes[2] &lt;&lt; 1) | (bytes[3] >> 4);
	output[outputOffset + 2] = ((bytes[3] &amp; 0x0F) &lt;&lt; 4) | (bytes[4] >> 1);
	output[outputOffset + 3] = ((bytes[4] &amp; 0x01) &lt;&lt; 7) | (bytes[5] &lt;&lt; 2) | (bytes[6] >> 3);
	output[outputOffset + 4] = ((bytes[6] &amp; 0x07) &lt;&lt; 5) | bytes[7];
};

// endregion

/**
 * Base32 encodes a binary buffer.
 * @param {Uint8Array} data Binary data to encode.
 * @returns {string} Base32 encoded string corresponding to the input data.
 */
const encode = data => {
	if (0 !== data.length % DECODED_BLOCK_SIZE)
		throw Error(`decoded size must be multiple of ${DECODED_BLOCK_SIZE}`);

	const output = new Array(data.length / DECODED_BLOCK_SIZE * ENCODED_BLOCK_SIZE);
	for (let i = 0; i &lt; data.length / DECODED_BLOCK_SIZE; ++i)
		encodeBlock(data, i * DECODED_BLOCK_SIZE, output, i * ENCODED_BLOCK_SIZE);

	return output.join('');
};

/**
 * Base32 decodes a base32 encoded string.
 * @param {string} encoded Base32 encoded string to decode.
 * @returns {Uint8Array} Binary data corresponding to the input string.
 */
const decode = encoded => {
	if (0 !== encoded.length % ENCODED_BLOCK_SIZE)
		throw Error(`encoded size must be multiple of ${ENCODED_BLOCK_SIZE}`);

	const output = new Uint8Array(encoded.length / ENCODED_BLOCK_SIZE * DECODED_BLOCK_SIZE);
	for (let i = 0; i &lt; encoded.length / ENCODED_BLOCK_SIZE; ++i)
		decodeBlock(encoded, i * ENCODED_BLOCK_SIZE, output, i * DECODED_BLOCK_SIZE);

	return output;
};

export default { encode, decode };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Address.html">Address</a></li><li><a href="AesCbcCipher.html">AesCbcCipher</a></li><li><a href="AesGcmCipher.html">AesGcmCipher</a></li><li><a href="Bip32.html">Bip32</a></li><li><a href="Bip32Node.html">Bip32Node</a></li><li><a href="BranchNode.html">BranchNode</a></li><li><a href="CharacterMapBuilder.html">CharacterMapBuilder</a></li><li><a href="Hash256.html">Hash256</a></li><li><a href="KeyPair.html">KeyPair</a></li><li><a href="LeafNode.html">LeafNode</a></li><li><a href="MerkleHashBuilder.html">MerkleHashBuilder</a></li><li><a href="Network.html">Network</a></li><li><a href="NetworkLocator.html">NetworkLocator</a></li><li><a href="NetworkTimestamp.html">NetworkTimestamp</a></li><li><a href="NetworkTimestampDatetimeConverter.html">NetworkTimestampDatetimeConverter</a></li><li><a href="PatriciaMerkleProofResult.html">PatriciaMerkleProofResult</a></li><li><a href="PrivateKey.html">PrivateKey</a></li><li><a href="PublicKey.html">PublicKey</a></li><li><a href="SharedKey256.html">SharedKey256</a></li><li><a href="Signature.html">Signature</a></li><li><a href="TreeNode.html">TreeNode</a></li><li><a href="Verifier.html">Verifier</a></li><li><a href="module.exports.html">exports</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addArrayParser">addArrayParser</a></li><li><a href="global.html#addEnumParser">addEnumParser</a></li><li><a href="global.html#addFlagsParser">addFlagsParser</a></li><li><a href="global.html#addPodParser">addPodParser</a></li><li><a href="global.html#addStructParser">addStructParser</a></li><li><a href="global.html#alignUp">alignUp</a></li><li><a href="global.html#attachSignature">attachSignature</a></li><li><a href="global.html#autodetect">autodetect</a></li><li><a href="global.html#bip32NodeToKeyPair">bip32NodeToKeyPair</a></li><li><a href="global.html#bip32Path">bip32Path</a></li><li><a href="global.html#bytesToBigInt">bytesToBigInt</a></li><li><a href="global.html#bytesToBigIntUnaligned">bytesToBigIntUnaligned</a></li><li><a href="global.html#bytesToInt">bytesToInt</a></li><li><a href="global.html#bytesToIntUnaligned">bytesToIntUnaligned</a></li><li><a href="global.html#copyTo">copyTo</a></li><li><a href="global.html#cosignTransaction">cosignTransaction</a></li><li><a href="global.html#create">create</a></li><li><a href="global.html#createEmbedded">createEmbedded</a></li><li><a href="global.html#createFromFactory">createFromFactory</a></li><li><a href="global.html#decode">decode</a></li><li><a href="global.html#deepCompare">deepCompare</a></li><li><a href="global.html#deriveSharedKey">deriveSharedKey</a></li><li><a href="global.html#deriveSharedKeyDeprecated">deriveSharedKeyDeprecated</a></li><li><a href="global.html#deriveSharedKeyFactory">deriveSharedKeyFactory</a></li><li><a href="global.html#deriveSharedSecretFactory">deriveSharedSecretFactory</a></li><li><a href="global.html#deserializePatriciaTreeNodes">deserializePatriciaTreeNodes</a></li><li><a href="global.html#encode">encode</a></li><li><a href="global.html#encodeDeprecated">encodeDeprecated</a></li><li><a href="global.html#encodePersistentHarvestingDelegation">encodePersistentHarvestingDelegation</a></li><li><a href="global.html#generate">generate</a></li><li><a href="global.html#generateMosaicAliasId">generateMosaicAliasId</a></li><li><a href="global.html#generateMosaicId">generateMosaicId</a></li><li><a href="global.html#generateNamespaceId">generateNamespaceId</a></li><li><a href="global.html#generateNamespacePath">generateNamespacePath</a></li><li><a href="global.html#hashEmbeddedTransactions">hashEmbeddedTransactions</a></li><li><a href="global.html#hashTransaction">hashTransaction</a></li><li><a href="global.html#hexToUint8">hexToUint8</a></li><li><a href="global.html#intToBytes">intToBytes</a></li><li><a href="global.html#isHexString">isHexString</a></li><li><a href="global.html#isValidNamespaceName">isValidNamespaceName</a></li><li><a href="global.html#lookupTransactionName">lookupTransactionName</a></li><li><a href="global.html#lookupValue">lookupValue</a></li><li><a href="global.html#merklePath%255Bundefined%255D">merklePath[undefined]</a></li><li><a href="global.html#metadataUpdateValue">metadataUpdateValue</a></li><li><a href="global.html#proveMerkle">proveMerkle</a></li><li><a href="global.html#provePatriciaMerkle">provePatriciaMerkle</a></li><li><a href="global.html#publicKey">publicKey</a></li><li><a href="global.html#readArray">readArray</a></li><li><a href="global.html#readArrayCount">readArrayCount</a></li><li><a href="global.html#readVariableSizeElements">readVariableSizeElements</a></li><li><a href="global.html#ripemdKeccak256">ripemdKeccak256</a></li><li><a href="global.html#ruleNames">ruleNames</a></li><li><a href="global.html#setTypeHints">setTypeHints</a></li><li><a href="global.html#shiftRight">shiftRight</a></li><li><a href="global.html#shrink">shrink</a></li><li><a href="global.html#signTransaction">signTransaction</a></li><li><a href="global.html#size">size</a></li><li><a href="global.html#toByte">toByte</a></li><li><a href="global.html#toNonVerifiableTransaction">toNonVerifiableTransaction</a></li><li><a href="global.html#toString">toString</a></li><li><a href="global.html#tryDecode">tryDecode</a></li><li><a href="global.html#tryDecodeDeprecated">tryDecodeDeprecated</a></li><li><a href="global.html#tryParseUint">tryParseUint</a></li><li><a href="global.html#uint8ToHex">uint8ToHex</a></li><li><a href="global.html#verifyTransaction">verifyTransaction</a></li><li><a href="global.html#window">window</a></li><li><a href="global.html#write">write</a></li><li><a href="global.html#writeArray">writeArray</a></li><li><a href="global.html#writeArrayCount">writeArrayCount</a></li><li><a href="global.html#writeVariableSizeElements">writeVariableSizeElements</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Thu Feb 29 2024 23:58:00 GMT+0900 (Japan Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
